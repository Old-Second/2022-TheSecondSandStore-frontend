{"version":3,"file":"pages/changeUserinfo/index.js","sources":["webpack:///._src_pages_changeUserinfo_index.jsx","webpack:///._src_pages_changeUserinfo_index.css","webpack:///./src/pages/changeUserinfo/index.jsx?acad"],"sourcesContent":["import { Component } from 'react'\nimport Taro from '@tarojs/taro'\nimport { View, Button, Image, Input } from '@tarojs/components'\nimport './index.css'\nimport Fetch from '../../Service/fetch'\n\nexport default class Index extends Component {\n\n  state = {\n    user: [],\n    image: '',\n    nickname: ''\n  }\n\n  componentDidMount() {\n    Fetch(`/user`, {}, 'GET')\n      .then(res => {\n        if (res.data) {\n          this.setState({ user: res.data })\n        }\n      })\n  }\n\n  changeAvater = () => {\n    const params = {};\n    params.count = 1;\n    params.sizeType = ['original', 'compressed'];\n    params.sourceType = ['album', 'camera'];\n    Taro.chooseImage(params)\n      .then(res => {\n        const { tempFilePaths } = res\n        const file = Taro.getFileSystemManager().readFileSync(tempFilePaths[0], \"base64\")\n        this.setState({\n          tempavatar: tempFilePaths[0],\n          image: file,\n        });\n      })\n      .catch(error => {\n        console.error(error);\n      });\n  }\n\n  changeName = (e) => {\n    this.setState({\n      nickname: e.target.value\n    });\n  }\n\n  cleartemp = () => {\n    this.setState({\n      tempavatar: ''\n    })\n  }\n\n  handleinfo = () => {\n    const { image, nickname } = this.state\n    Fetch(`/user/image`, { image }, 'PUT')\n    Fetch(`/user/nickname`, { nickname }, 'PUT')\n    if (!nickname && !image) {\n      Taro.showToast({\n        icon: 'none',\n        title: '昵称或头像不能为空'\n      });\n    } else {\n      Taro.showToast({\n        icon: 'none',\n        title: '修改成功'\n      });\n    }\n  }\n\n  render() {\n    const { tempavatar, nickname, user } = this.state\n    return (\n      <View className='index'>\n        <View className='from-content'>\n          <View className='avatar'>\n            <View>修改头像</View>\n            <Image\n              src={tempavatar ? tempavatar : `http://${user.image}`}\n              onClick={this.changeAvater}\n              className='avatar-img'\n            ></Image>\n            <View className='icon-right'>\n            </View>\n          </View>\n          <View className='user-name'>\n            <View className='nick'>修改昵称</View>\n            <Input\n              maxLength='10'\n              className='nick-input'\n              placeholder='昵称'\n              value={nickname}\n              onInput={this.changeName}\n            />\n            <View className='icon-right'>\n            </View>\n          </View>\n        </View>\n        <View className='from-button'>\n          <Button className='reset-button' onClick={this.cleartemp}>\n            取消\n          </Button>\n          <Button className='submit-button' onClick={this.handleinfo}>\n            保存\n          </Button>\n        </View>\n        {/* <View className='log-out' onClick={this.handleLogout.bind(this)}>\n          退出登陆\n        </View> */}\n      </View>\n\n    )\n  }\n}","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/babel-loader/lib/index.js!./index.jsx\"\nvar config = {\"navigationBarTitleText\":\"修改个人信息\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/changeUserinfo/index', {root:{cn:[]}}, config || {}))\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;AAEA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAHA;AACA;AAcA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAJA;AAUA;AAVA;;;AAcA;AACA;AACA;AADA;;;AAKA;AACA;AACA;AADA;;;AAKA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;AACA;AAFA;AAIA;;;;;;;;AAtDA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AAJA;AAMA;;;AAkDA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AAHA;AAKA;AAAA;AAPA;AAUA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAOA;AAAA;AATA;AAXA;AAwBA;AAAA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAJA;AAzBA;AAuCA;;;;AA3GA;AACA;;;;;;;;;;;;ACPA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}