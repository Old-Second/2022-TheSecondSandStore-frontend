{"version":3,"file":"pages/changeUserinfo/index.js","sources":["webpack:///._src_pages_changeUserinfo_index.jsx","webpack:///._src_pages_changeUserinfo_index.css","webpack:///./src/pages/changeUserinfo/index.jsx?acad"],"sourcesContent":["import { Component } from 'react'\r\nimport Taro from '@tarojs/taro'\r\nimport { View, Button, Image, Input } from '@tarojs/components'\r\nimport './index.css'\r\nimport Fetch from '../../Service/fetch'\r\n\r\nexport default class Index extends Component {\r\n\r\n  state = {\r\n    user: [],\r\n    image: '',\r\n    nickname: ''\r\n  }\r\n\r\n  componentDidMount() {\r\n    Fetch(`/user`, {}, 'GET')\r\n      .then(res => {\r\n        if (res.data) {\r\n          this.setState({ user: res.data })\r\n        }\r\n      })\r\n  }\r\n\r\n  changeAvater = () => {\r\n    const params = {};\r\n    params.count = 1;\r\n    params.sizeType = ['original', 'compressed'];\r\n    params.sourceType = ['album', 'camera'];\r\n    Taro.chooseImage(params)\r\n      .then(res => {\r\n        const { tempFilePaths } = res\r\n        const file = Taro.getFileSystemManager().readFileSync(tempFilePaths[0], \"base64\")\r\n        this.setState({\r\n          tempavatar: tempFilePaths[0],\r\n          image: file,\r\n        });\r\n      })\r\n      .catch(error => {\r\n        console.error(error);\r\n      });\r\n  }\r\n\r\n  changeName = (e) => {\r\n    this.setState({\r\n      nickname: e.target.value\r\n    });\r\n  }\r\n\r\n  cleartemp = () => {\r\n    this.setState({\r\n      tempavatar: ''\r\n    })\r\n  }\r\n\r\n  handleinfo = () => {\r\n    const { image, nickname } = this.state\r\n    Fetch(`/user/image`, { image }, 'PUT')\r\n    Fetch(`/user/nickname`, { nickname }, 'PUT')\r\n    if (!nickname || !image) {\r\n      Taro.showToast({\r\n        icon: 'none',\r\n        title: '昵称或头像不能为空'\r\n      });\r\n    } else {\r\n      Taro.showToast({\r\n        icon: 'none',\r\n        title: '修改成功'\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { tempavatar, nickname, user } = this.state\r\n    return (\r\n      <View className='index'>\r\n        <View className='from-content'>\r\n          <View className='avatar'>\r\n            <View>修改头像</View>\r\n            <Image\r\n              src={tempavatar ? tempavatar : `http://${user.image}`}\r\n              onClick={this.changeAvater}\r\n              className='avatar-img'\r\n            ></Image>\r\n            <View className='icon-right'>\r\n            </View>\r\n          </View>\r\n          <View className='user-name'>\r\n            <View className='nick'>修改昵称</View>\r\n            <Input\r\n              maxLength='10'\r\n              className='nick-input'\r\n              placeholder='昵称'\r\n              value={nickname}\r\n              onInput={this.changeName}\r\n            />\r\n            <View className='icon-right'>\r\n            </View>\r\n          </View>\r\n        </View>\r\n        <View className='from-button'>\r\n          <Button className='reset-button' onClick={this.cleartemp}>\r\n            取消\r\n          </Button>\r\n          <Button className='submit-button' onClick={this.handleinfo}>\r\n            保存\r\n          </Button>\r\n        </View>\r\n        {/* <View className='log-out' onClick={this.handleLogout.bind(this)}>\r\n          退出登陆\r\n        </View> */}\r\n      </View>\r\n\r\n    )\r\n  }\r\n}","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/babel-loader/lib/index.js!./index.jsx\"\nvar config = {\"navigationBarTitleText\":\"修改个人信息\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/changeUserinfo/index', {root:{cn:[]}}, config || {}))\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;AAEA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAHA;AACA;AAcA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAJA;AAUA;AAVA;;;AAcA;AACA;AACA;AADA;;;AAKA;AACA;AACA;AADA;;;AAKA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;AACA;AAFA;AAIA;;;;;;;;AAtDA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AAJA;AAMA;;;AAkDA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AAHA;AAKA;AAAA;AAPA;AAUA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAOA;AAAA;AATA;AAXA;AAwBA;AAAA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAJA;AAzBA;AAuCA;;;;AA3GA;AACA;;;;;;;;;;;;ACPA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}