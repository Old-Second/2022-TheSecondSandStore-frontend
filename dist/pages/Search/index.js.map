{"version":3,"file":"pages/Search/index.js","sources":["webpack:///._src_pages_Search_index.jsx","webpack:///._src_Images_delete.png","webpack:///._src_pages_Search_index.css","webpack:///./src/pages/Search/index.jsx?20f5"],"sourcesContent":["import { Component } from 'react'\nimport { View,Input, Text,Image} from '@tarojs/components'\nimport Taro from '@tarojs/taro'\nimport './index.css'\nimport Item from '../../Components/Item'\nimport image from '../../Images/搜索.png'\nimport back from '../../Images/back.png'\nimport Delete from '../../Images/delete.png'\nimport Fetch from '../../Service/fetch'\n\n\nexport default class Index extends Component {\n    state={\n      historys:[\n                ],\n      goods:[],\n      inputVal:'',\n      condition:'',\n      hidden:false,\n      show:true,\n      ifdelete:true //初始状态不显示x号\n    }\n    componentWillMount () { }\n  \n    componentDidMount () { }\n  \n    componentWillUnmount () { }\n  \n    componentDidShow () { \n      let historys = Taro.getStorageSync('history') || [];\n      this.setState({\n      historys: historys\n      });\n    }\n  \n    componentDidHide () { }\n\n/* //focus \n    handleFocus=()=> {\n      let historys = Taro.getStorageSync('history') || [];\n      this.setState({\n      historys: historys\n      });\n    } */\n//oninput\n      onInput(e) {\n          const value = e.detail.value\n          this.setState({\n            inputVal:value,\n            condition:value\n          })\n        }\n\n  //confirm of Input\n      handleConfirm=()=> {\n        const inputVal = this.state.inputVal\n        const {historys,condition} = this.state\n        if (inputVal.trim()!=='') {\n          console.log(inputVal)\n          if (historys.length < 8) {\n            const history={id:historys.length ,name: inputVal}\n            const newhistorys=[history,...historys]\n            \n            this.setState({\n              hidden: true,\n              historys: newhistorys,\n            });\n           Taro.setStorageSync('history', newhistorys);\n           this.getsearch(condition)\n        }}\n      }\n//清除历史记录\n      clearHistory =()=>{\n        const ifdelete = this.state.ifdelete\n        const ifDelete = !ifdelete\n        this.setState({\n          ifdelete:ifDelete\n        })\n        /* this.setState({\n          historys: []\n        });\n        Taro.setStorageSync('history', []); */\n      }\n\n      handleDelete=(id)=>{\n          const{historys}=this.state\n          const newHistorys = historys.filter((history) => {\n            return history.id!==id\n          })\n          this.setState({historys:newHistorys});\n          Taro.setStorageSync('history',newHistorys)\n      }\n\n//返回主页\n      handleBack=()=>{\n        Taro.reLaunch({\n          url:'/pages/Square/Square'\n        })\n      }\n     \n//搜索结果\n      getsearch=(condition)=>{\n        Fetch(\n          `/goods/details/all/condition/${condition}`,\n          {},\n          'GET'\n        ).then(data=>{\n          console.log(data);\n          let newGoods = this.state.goods;\n            if (data.data !== null) {\n                    newGoods = newGoods.concat(data.data);\n                    Taro.stopPullDownRefresh();\n                    Taro.hideNavigationBarLoading();\n                    this.setState({\n                      goods: newGoods,\n                      show:false\n                      });\n            }else{\n              Taro.showToast({\n                    title: '到底啦！',\n                    duration: 2000\n              });\n              Taro.stopPullDownRefresh();\n              Taro.hideNavigationBarLoading();\n                }\n              })\n          }\n//click历史记录\n          handleClickContent = ( name )=>{\n            this.getsearch(name)\n            this.setState({hidden: true})\n          }\n\n        \n    render () {\n      const {historys,hidden,goods,show,ifdelete}= this.state \n      const inputVal = this.state.inputVal\n      return (\n      <View>\n        <View className='search-header'> \n            <Image src={back} style={{width:20,height:20,marginLeft:10}} onClick={this.handleBack} />\n            <Input type='text' placeholder='' value={inputVal} onInput={this.onInput.bind(this)}  focus />\n            <Image src={image} style={{width:32,height:32}} onClick={this.handleConfirm} />\n        </View>  \n{/* 搜索历史 */}\n        { hidden?null:<View className='box'>\n          <View className='History'>\n            {historys.map((history) => {\n                return  (\n            <View className='search-history' style={{display: historys.length ? 'block' : 'none'}} key='Search' >\n               <Text key={history.id} onClick={()=>this.handleClickContent(history.name)} >{history.name}</Text>\n        {/* x号 */} \n               { ifdelete ? null:<Text onClick={()=>this.handleDelete(history.id)} style={{marginLeft:7}} >×</Text>}\n            </View>\n               )})}\n          </View>\n          <Image src={Delete} style={{width:25,height:25,marginLeft:15 }} onClick={this.clearHistory} ></Image>\n        </View> }\n          \n          {/* 商品 */}\n        { show ? null:<View className='show'>\n          {goods.map((good) => {\n              return (\n              <Item content={good.content} price={good.price} iffavorite={good.if_collected} username={good.user_nickname} QQ={good.qq_account} user_image={good.user_image} item_image={good.goods_images_videos} goods_id={good.id} key='item' />\n            )\n          })}\n        </View>\n        }\n      </View> \n      )\n    }\n  }","module.exports = __webpack_public_path__ + \"Images/delete.png\";","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/babel-loader/lib/index.js!./index.jsx\"\nvar config = {\"navigationBarTitleText\":\"搜索\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/Search/index', {root:{cn:[]}}, config || {}))\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAGA;;;;;;;;;;;;;;;;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AACA;AAyCA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAGA;AACA;AAAA;AACA;AAAA;;;AAGA;AACA;AACA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AADA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;;;AAIA;AACA;AACA;AADA;;;AAMA;AACA;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAJA;AASA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAtBA;;;AA0BA;AACA;AACA;AAAA;AAAA;AAAA;;;;;;;;AA5GA;;;AAEA;;;AAEA;;;AAEA;AACA;AACA;AACA;AADA;AAGA;;;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAAA;AACA;AACA;AACA;AACA;AAFA;AAMA;AACA;;;AAgFA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;AAMA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;AAFA;AADA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAXA;AAeA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AADA;AAtBA;AAgCA;;;;AA/JA;AACA;;;;;;;;;;;;;ACZA;;;;;;;;;;;ACAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}