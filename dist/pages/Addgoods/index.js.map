{"version":3,"file":"pages/Addgoods/index.js","sources":["webpack:///._src_pages_Addgoods_index.jsx","webpack:///._src_Components_Modal4_index.css","webpack:///._src_Components_Modal4_index.jsx","webpack:///._src_pages_Addgoods_index.css","webpack:///./src/pages/Addgoods/index.jsx?23b7"],"sourcesContent":["import { Component } from 'react'\r\nimport Taro from '@tarojs/taro'\r\nimport { View, Textarea, Button, Image, Input, Text,Canvas } from '@tarojs/components'\r\nimport './index.css'\r\nimport Modal4 from '../../Components/Modal4'\r\n\r\nexport default class Index extends Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      text: '客官，请留下您的联系方式',\r\n      place: '请输入您的QQ号',\r\n      hidden: true,\r\n      images: [],\r\n      tempImage: [],\r\n      price: '',\r\n      description:''\r\n    }\r\n  }\r\n  componentDidShow() {\r\n    this.setState({\r\n      images: [],\r\n      tempImage: [],\r\n      price: '',\r\n      description:''\r\n    })\r\n  }\r\n\r\n  toTags() {\r\n    Taro.navigateTo({\r\n      url: '/pages/Tags/index'\r\n    })\r\n  }\r\n\r\n  showModal = () => {\r\n    const ifHidden = this.state.hidden\r\n    const Hidden = !ifHidden\r\n    this.setState({\r\n      hidden: Hidden,\r\n    })\r\n  }\r\n\r\n  changeHidden = () => {\r\n    const ifHidden = this.state.hidden\r\n    const Hidden = !ifHidden\r\n    this.setState({ hidden: Hidden })\r\n  }\r\n\r\n  addImage = () => {\r\n    const { images, tempImage } = this.state\r\n    const params = {};\r\n    params.count = 1;\r\n    params.sizeType = ['original', 'compressed'];\r\n    params.sourceType = ['album', 'camera'];\r\n    Taro.chooseImage(params)\r\n      .then(res => {\r\n        const { tempFilePaths } = res\r\n        const file = Taro.getFileSystemManager().readFileSync(tempFilePaths[0], \"base64\")\r\n        this.setState({\r\n          images: [...images, file],\r\n          tempImage: [...tempImage, tempFilePaths[0]]\r\n        });\r\n      })\r\n  }\r\n\r\n  compressImage = () => {\r\n    Taro.compressImage()\r\n  }\r\n\r\n  handleText = (e) => {\r\n    this.setState({ description: e.target.value });\r\n  }\r\n\r\n  handlePrice = (e) => {\r\n    this.setState({ price: e.target.value });\r\n  }\r\n\r\n  render() {\r\n    const { tempImage } = this.state\r\n    return (\r\n      <View>\r\n        <View className='AddGoods_container'>\r\n          <Textarea type='number' placeholder='请描述一下你的宝贝' maxlength={250} className='AddGoods_textarea' value={this.state.description} onInput={this.handleText}></Textarea>\r\n          <View className='AddGoods_price'>\r\n            定价：\r\n            <View>\r\n              <Text>￥</Text>\r\n              <Input placeholder='00.00' placeholderStyle='color:red' type='number' onInput={this.handlePrice} />\r\n            </View>\r\n          </View>\r\n          <Button onClick={this.toTags} className='AddGoods_tag'>#</Button>\r\n          <View>\r\n            {tempImage.map((image) => {\r\n              return <Image key={image.id} src={image} />\r\n            })}\r\n            <View className='AddGoods_addimg' onClick={this.addImage}></View>\r\n          </View>\r\n        </View>\r\n        <Button className='AddGoods_sell' onClick={this.showModal}>发布</Button>\r\n        <Modal4 price={this.state.price} images={this.state.images} description={this.state.description} hidden={this.state.hidden} changeHidden={this.changeHidden} text={this.state.text} place={this.state.place} maxlength='10' />\r\n      </View>\r\n    )\r\n  }\r\n}","// extracted by mini-css-extract-plugin","import { Component } from 'react'\r\nimport Taro from '@tarojs/taro'\r\nimport { View, Text, Input, Button } from '@tarojs/components'\r\nimport './index.css'\r\nimport Fetch from '../../Service/fetch'\r\n\r\nexport default class Index extends Component {\r\n\r\n  state = {\r\n    videos: [],\r\n    tag_ids: []\r\n  }\r\n\r\n  handleCancle = () => {\r\n    this.props.changeHidden()\r\n  }\r\n\r\n  getqq = (e) => {\r\n    this.setState({\r\n      qq_account: e.target.value\r\n    })\r\n  }\r\n\r\n  getCurrentTime = () => {\r\n    var date = new Date();\r\n    var year = date.getFullYear();\r\n    var month = date.getMonth() + 1;\r\n    var day = date.getDate();\r\n    //时\r\n    var hour = date.getHours();\r\n    //分  \r\n    var minute = date.getMinutes()\r\n    //秒 \r\n    var second = date.getSeconds();\r\n\r\n    if (month < 10) {\r\n      month = \"0\" + month;\r\n    }\r\n    if (day < 10) {\r\n      day = \"0\" + day;\r\n    }\r\n    if (hour < 10) {\r\n      hour = \"0\" + hour;\r\n    }\r\n    if (minute < 10) {\r\n      minute = \"0\" + minute;\r\n    }\r\n    if (second < 10) {\r\n      second = \"0\" + second;\r\n    }\r\n\r\n    return year + \"-\" + month + \"-\" + day + \" \" + hour + \":\" + minute + \":\" + second\r\n  }\r\n\r\n  debounce(f) {\r\n    var timer = null\r\n    return function () {\r\n      if (timer) {\r\n        clearTimeout(timer)\r\n      }\r\n\r\n      timer = setTimeout(() => {\r\n        f.call(this)\r\n      }, 1000)\r\n    }\r\n  }\r\n\r\n  handleConfirm = () => {\r\n    const time = this.getCurrentTime()\r\n    const { price, description, images } = this.props\r\n    const { qq_account, videos, tag_ids } = this.state\r\n    if (qq_account) {\r\n      Fetch('/goods', { qq_account, price, images, description, tag_ids, videos, time }, 'POST')\r\n        .then(() => {\r\n          this.props.changeHidden()\r\n          Taro.showToast({\r\n            icon: 'none',\r\n            title: '发布成功'\r\n          });\r\n        })\r\n    } else {\r\n      Taro.showToast({\r\n        icon: 'none',\r\n        title: '请输入QQ号'\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { hidden, text, place } = this.props\r\n    return (\r\n      <View>\r\n        {hidden ? null : <View class='toast-box' >\r\n          <View class='toastbg'></View>\r\n          <View class='showToast'>\r\n            <View class='toast-title'>\r\n              <Text>{text}</Text>\r\n            </View>\r\n            <View class='toast-main'>\r\n              <View class='toast-input'>\r\n                <Input placeholder={place} onInput={this.getqq} maxlength={15}></Input>\r\n              </View>\r\n            </View>\r\n            <View class='toast-button'>\r\n              <View class='button1'>\r\n                <Button catchtap='cancel' onClick={this.handleCancle}>取消</Button>\r\n              </View>\r\n              <View class='button2'>\r\n                <Button catchtap='confirm' onClick={this.debounce(this.handleConfirm)}>确定</Button>\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </View>}\r\n      </View>\r\n    )\r\n  }\r\n}","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/babel-loader/lib/index.js!./index.jsx\"\nvar config = {\"navigationBarTitleText\":\"发布商品\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/Addgoods/index', {root:{cn:[]}}, config || {}))\n\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;AAEA;;;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AA4BA;AACA;AACA;AAAA;AACA;AADA;AA9BA;AACA;AADA;AAoCA;AACA;AACA;AAAA;AAAA;AAAA;AAtCA;AACA;AADA;AA0CA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAJA;AA/CA;AACA;AADA;AA2DA;AA3DA;AACA;AADA;AA+DA;AAAA;AAAA;AA/DA;AACA;AADA;AAmEA;AAAA;AAAA;AAnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAFA;AAWA;AACA;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;;;AAEA;AACA;AACA;AADA;AAGA;;;AA6CA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAFA;AAFA;AAOA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AADA;AAGA;AAAA;AAAA;AAJA;AAVA;AAiBA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAnBA;AAsBA;;;;AAjGA;AACA;;;;;;;;;;;;ACPA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;;;;AAEA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAcA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;;;;;;AAjCA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAuBA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AADA;AAGA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AADA;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAGA;AAAA;AACA;AAAA;AAAA;AAAA;AADA;AAJA;AATA;AAFA;AADA;AAwBA;;;;AA7GA;AACA;;;;;;;;;;;;ACPA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}